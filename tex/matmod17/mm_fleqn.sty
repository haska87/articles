% fleqn.sty 26-Sep-89

\newlength{\ourvmskip}
\ourvmskip=.35cm plus 0.2cm minus 0.1cm
\topsep=\ourvmskip


%\def\cases#1{\left\{\,\vcenter{\baselineskip=\ourvmskip\m@th

% вставили на глазок \baselineskip=20pt вместо \normalbaselineskip

%\def\cases#1{\left\{\,\vcenter{\baselineskip=20pt\m@th
%\def\cases#1{\left\{\,\vcenter{\baselineskip=30pt\m@th
%    \ialign{$##\hfil$&\quad##\hfil\crcr#1\crcr}}\right.}


\def\casesp#1#2{\left\{\,\vcenter{\baselineskip=#1\m@th
    \ialign{$##\hfil$&\quad##\hfil\crcr#2\crcr}}\right.}

%\def\[{\relax\ifmmode\@badmath\else
% \begin{trivlist}
% \@beginparpenalty\predisplaypenalty
% \@endparpenalty\postdisplaypenalty
% \item[]\leavevmode
% \hbox to\linewidth\bgroup$ \displaystyle
% \hskip\mathindent\bgroup\fi}
%\def\]{\relax\ifmmode \egroup $\hfil \egroup \end{trivlist}\else \@badmath \fi}

\def\equation{\@beginparpenalty\predisplaypenalty
 \@endparpenalty\postdisplaypenalty
\refstepcounter{equation}\list{}{\leftmargin=0pt\partopsep=0pt\topsep=\ourvmskip} \item[]\leavevmode
 \hbox to\linewidth\bgroup $ \displaystyle
\hskip\mathindent}
\def\endequation{$\hfil \displaywidth\linewidth\@eqnnum\egroup \endlist}

%\def\equation{\@beginparpenalty\predisplaypenalty
% \@endparpenalty\postdisplaypenalty
%\refstepcounter{equation}\trivlist \item[]\leavevmode
% \hbox to\linewidth\bgroup $ \displaystyle
%\hskip\mathindent}
%\def\endequation{$\hfil \displaywidth\linewidth\@eqnnum\egroup \endtrivlist}

\def\eqnarray{\stepcounter{equation}\let\@currentlabel=\theequation
\global\@eqnswtrue
\global\@eqcnt\z@\tabskip\mathindent\let\\=\@eqncr
\abovedisplayskip\topsep %\ifvmode\advance\abovedisplayskip\partopsep\fi
\belowdisplayskip\abovedisplayskip
\belowdisplayshortskip\abovedisplayskip
\abovedisplayshortskip\abovedisplayskip
$$\halign to
\linewidth\bgroup\@eqnsel\hskip\@centering$\displaystyle\tabskip\z@
 {##}$&\global\@eqcnt\@ne \hskip 2\arraycolsep \hfil${##}$\hfil
 &\global\@eqcnt\tw@ \hskip 2\arraycolsep $\displaystyle{##}$\hfil
 \tabskip\@centering&\llap{##}\tabskip\z@\cr}

\def\endeqnarray{\@@eqncr\egroup
 \global\advance\c@equation\m@ne$$\global\@ignoretrue }
\newdimen\mathindent
%\mathindent = \leftmargini
%--------------------------------------------------------------
\mathindent=\parindent

%\def\mmeqno{}
%
%\def\M{\@beginparpenalty\predisplaypenalty
%%\def\M#1{\@beginparpenalty\predisplaypenalty
%%\def\mmeqno{(#1)}
% \@endparpenalty\postdisplaypenalty
%                        \trivlist \item[]\leavevmode
%%                         \list{}{} \item[]\leavevmode
% \hbox to\linewidth\bgroup $ \displaystyle
%\hskip\mathindent}
%\def\endM{$\hfil\egroup \endlist}
%%\def\endM{$\hfil \displaywidth\linewidth {}\egroup \endtrivlist}
%%\def\endM{$\hfil \displaywidth\linewidth {\mmeqno}\egroup \endlist}

\newcommand{\eqmm}{\hfill}

\def\[{\relax\ifmmode\@badmath\else
 \begin{list}{}{\leftmargin=0pt\partopsep=0pt\topsep=\ourvmskip}
% \begin{trivlist}
 \@beginparpenalty\predisplaypenalty
 \@endparpenalty\postdisplaypenalty
 \item[]\leavevmode
 \hbox to\linewidth\bgroup$ \displaystyle
 \hskip\mathindent\fi}
%\def\]{\relax\ifmmode $\hfil \egroup \end{trivlist}\else \@badmath \fi}
\def\]{\relax\ifmmode $\hfil \egroup \end{list}\else \@badmath \fi}

